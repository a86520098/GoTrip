<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="frontend/partials/fragment :: head"></head>

<body class="">
	<!-- Header -->
	<header th:replace="frontend/partials/fragment :: header"></header>
	<!-- Cart 購物車 -->
	<div th:replace="frontend/partials/fragment :: cart"></div>

	<section class="bg-img1 txt-center p-lr-15 p-tb-92"	th:style="'background-image: url(' + @{/images/bg-02.jpg} + ');'">
		<h2 class="ltext-103 font-weight-bold clwhite txt-center">租車管理</h2>
	</section>
	<!-- Product 內文 -->
	<div class="bg0">
		<div class="container">
			<div class="row">
				<div class="col-md-3 p-b-80 bg6">
					<div class="side-menu">
						<div class="p-t-55">
							<h2 class="ltext-103 cl5 font-weight-bold m-b-30 p-lr-20">租車管理</h2>
							<ul class="p-lr-20">
								<li class="bor18">
									<a th:href="@{#}" class="dis-block mtext-110 cl5 hov-cl1 trans-04 p-tb-12 ">
										檢視訂單
									</a>
								</li>
								<li class="bor18">
									<a th:href="@{/vendor/cars/locations}" class="dis-block mtext-110 cl5 hov-cl1 trans-04 p-tb-12 ">
										地點與車款列表
									</a>
								</li>
								<li class="bor18">
									<a th:href="@{/vendor/cars/locations/form}" class="dis-block mtext-110 cl5 hov-cl1 trans-04 p-tb-12 ">
										新增地點資訊
									</a>
								</li>
								<li class="bor18">
									<a th:href="@{/vendor/cars/options/form}" class="dis-block mtext-110 cl5 hov-cl1 trans-04 p-tb-12 ">
										新增車款選項
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<!-- Block2 -->
				<div class="col-md-9 grid-margin my-5 pl-5">
					<div class="card">
						<div class="card-body ">
						
							<h4 class="card-title font-weight-bold my-3">租車選項</h4>
							
							<form id="insert-opt-form" name="form" th:action="@{/vendor/cars/options}" method="post" th:object="${carLocation}"
								  class="form-horizontal needs-validation">
								  
								<input th:field="*{id}" id="id" type="hidden"/>
								
								<div th:each="option, optionStat : *{carOptions}">
								
									<p class="card-description mt-4">車款資料</p>
									
									<!-- 隱藏的方案與車款id -->
									<input th:field="*{carOptions[__${optionStat.index}__].id}" id="name" type="hidden" class="form-control" />
									<input th:field="*{carOptions[__${optionStat.index}__].carModel.id}" id="name" type="hidden" class="form-control" />
										
									
<!-- 									<div class="row form-group my-4"> -->
<!-- 										<div class="col-lg-1"></div> -->
<!-- 										<label class="col-lg-2 col-form-label" for="name">車款</label> -->
<!-- 										<div class="col-lg-6"> -->
<!-- 											<span th:text="*{carOptions[__${optionStat.index}__].carModel.makeCh}" id="name"></span> -->
<!-- 											<span th:text="*{carOptions[__${optionStat.index}__].carModel.makeEn}" id="name"></span> -->
<!-- 											<span th:text="*{carOptions[__${optionStat.index}__].carModel.model}" id="name"></span> -->
<!-- 											<div class="invalid-feedback">請選擇車款</div> -->
<!-- 										</div> -->
<!-- 									</div> -->

									<div class="row form-group my-4">
										<div class="col-lg-3"></div>
										<div class="col-lg-2">
											<img th:src="@{*{carOptions[__${optionStat.index}__].carModel.image}}">
										</div>
										<div class="col-lg-2">
<!-- 											<p th:text="*{carOptions[__${optionStat.index}__].carModel.image}"> -->
										</div>
									</div>
									
									<div class="row form-group my-4">
										<div class="col-lg-1"></div>
										<label class="col-lg-2 col-form-label" for="name">車款</label>
										<div class="col-lg-7">
<!-- 											<div class="row"> -->
												<div class="pr-0">
													<input th:value="*{carOptions[__${optionStat.index}__].carModel.makeCh + '  ' + carOptions[__${optionStat.index}__].carModel.makeEn + '  ' + 
													carOptions[__${optionStat.index}__].carModel.model}" name="makeCh" type="text" class="form-control" readonly/>
												</div>
<!-- 												<div class="col-sm-4 pr-0"> -->
<!-- 													<input th:field="*{}" name="makeEn" type="text" class="form-control" readonly/> -->
<!-- 												</div> -->
<!-- 												<div class="col-sm-4"> -->
<!-- 													<input th:field="*{carOptions[__${optionStat.index}__].carModel.model}" name="model" type="text" class="form-control" readonly/> -->
<!-- 												</div> -->
<!-- 											</div> -->
											<div class="invalid-feedback">請選擇車款</div>
										</div>
									</div>
									
<!-- 									<div class="row form-group my-4"> -->
<!-- 										<div class="col-lg-1"></div> -->
<!-- 										<label class="col-lg-2 col-form-label" for="name">車款</label> -->
<!-- 										<div class="col-lg-6"> -->
<!-- 											<div class="row"> -->
<!-- 												<div class="col-sm-4 pr-0"> -->
<!-- 													<input th:field="*{carOptions[__${optionStat.index}__].carModel.makeCh}" name="makeCh" type="text" class="form-control" readonly/> -->
<!-- 												</div> -->
<!-- 												<div class="col-sm-4 pr-0"> -->
<!-- 													<input th:field="*{carOptions[__${optionStat.index}__].carModel.makeEn}" name="makeEn" type="text" class="form-control" readonly/> -->
<!-- 												</div> -->
<!-- 												<div class="col-sm-4"> -->
<!-- 													<input th:field="*{carOptions[__${optionStat.index}__].carModel.model}" name="model" type="text" class="form-control" readonly/> -->
<!-- 												</div> -->
<!-- 											</div> -->
<!-- 											<div class="invalid-feedback">請選擇車款</div> -->
<!-- 										</div> -->
<!-- 									</div> -->
									
									<div class="row form-group my-4">
										<div class="col-lg-1"></div>
										<label class="col-lg-2 col-form-label" for="price">定價</label>
										<div class="col-lg-6">
											<input th:field="*{carOptions[__${optionStat.index}__].price}" id="price" name="price" type="number" class="form-control" />
											<div class="invalid-feedback">請輸入地址</div>
										</div>
									</div>
									
									<div class="row form-group my-4">
										<div class="col-lg-1"></div>
										<label class="col-lg-2 col-form-label" for="discount">折扣</label>
										<div class="col-lg-6">
											<input th:field="*{carOptions[__${optionStat.index}__].discount}" id="discount" type="text" name="discount" class="form-control" placeholder="折扣請以小數格式輸入，輸入0.8即是打八折"/>
											<div class="invalid-feedback">折扣請以小數格式輸入，ex:輸入0.8即[原定價x0.8=銷售金額]</div>
										</div>
									</div>
								</div>
<!-- 								<select name="carModel" class="form-control"> -->
<!-- 									<option value="0">select option</option> -->
<!-- 									<option th:each="carModel : ${carModels}" th:value="${carModel.id}" th:text="${carModel.makeCh + carModel.makeEn + carModel.model}"></option> -->
<!-- 								</select> -->
								
								<div class="d-flex justify-content-end">
									<button id="btn-insert-opts" type="submit" class="btn btn-warning mr-2 justify-content-end mr-4">
										儲存資料
									</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer th:replace="frontend/partials/fragment :: footer"></footer>
	<!-- Back to top -->
	<div th:replace="frontend/partials/fragment :: toTop"></div>
	<!-- Modal1 -->
	<div th:replace="frontend/partials/fragment :: modal1"></div>
	<!-- javascript -->
	<div th:replace="frontend/partials/fragment :: script"></div>
	
	<script th:src="@{/js/tw-city-selector.min.js}"></script>
	<script>
// 	  	new TwCitySelector();

		 new TwCitySelector({
		    el: '.city-selector-set',
		    elCounty: '.county', // 在 el 裡查找 element
		    elDistrict: '.district', // 在 el 裡查找 element
		    elZipcode: '.zipcode' // 在 el 裡查找 element
		  });
	  	
		$('#carModel').on('change', function(){
	  		let carModelId = $(this).val();
			$.ajax({
				type: 'GET',
				url: '/gotrip/api/cars/models/' + carModelId,
				dataType: 'json',
				success: function(data) {
// 					let str = '<i class="zmdi zmdi-flash"></i> <span th:text="${option.carModel.power}" class="p-r-15"></span>'+
// 						'<i class="zmdi zmdi-wb-auto"></i> 變速 <span th:text="${option.carModel.transmission}" class="p-r-15"></span>'+
// 						'<i class="zmdi zmdi-airline-seat-recline-extra"></i> 座位 <span th:text="${option.carModel.seat}" class="p-r-15"></span>'+
// 						<i class="zmdi zmdi-car"></i> 排氣量 <span th:text="${option.carModel.engine}+'cc'" class="p-r-5"></span> ';
					$("#carModelInfo").html(str);
				},
				error: function() {
					console.log('error')
				}
			})
			
		})
		
		$('#btn-addModel').on('click', function() {
			
		})

		
		$(document).ready(function(){

			$('.county').focus()
			$('.county').val($('#county').text())
			$('.county').blur()
			
			$(".county option[value='"+$('.county option:selected').val($('#county').text())+"']").prop("selected",true);
			$('.district').focus()
			$('.district').val($('#district').text())
			$('.district').blur()
		})
		
		
		$(".btn-insert-opts").click(function(e){
			e.preventDefault();
			Swal.fire({
				icon: 'success',
				title: '儲存成功',
				text: "即將為您導回地點列表",
				showConfirmButton: false,
				timer: 1500
			});

			setInterval(function() {
				$('#insert-opt-form').submit()
			}, 1500);
		})
		
	
	</script>

</body>

</html>